# Week 2 - Action Item Extractor

ä¸€ä¸ªåŸºäº FastAPI + SQLite çš„å¾…åŠäº‹é¡¹æå–åº”ç”¨ï¼Œå¯ä»¥ä»è‡ªç”±æ ¼å¼çš„ç¬”è®°ä¸­è‡ªåŠ¨æå–å¯æ‰§è¡Œçš„è¡ŒåŠ¨é¡¹ã€‚æ”¯æŒåŸºäº LLMï¼ˆOllamaï¼‰çš„æ™ºèƒ½æå–åŠŸèƒ½ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå…¨æ ˆåº”ç”¨ï¼ŒåŒ…å«ï¼š

- **åç«¯**ï¼šFastAPI æœåŠ¡å™¨ï¼Œæä¾› RESTful API
- **å‰ç«¯**ï¼šç®€æ´çš„ HTML/JavaScript ç•Œé¢
- **æ•°æ®åº“**ï¼šSQLite æœ¬åœ°å­˜å‚¨
- **AI æå–**ï¼šé›†æˆ Ollama LLM è¿›è¡Œæ™ºèƒ½å¾…åŠäº‹é¡¹æå–

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ“ åˆ›å»ºå’Œç®¡ç†ç¬”è®°
- ğŸ¤– ä½¿ç”¨ LLM ä»æ–‡æœ¬ä¸­æ™ºèƒ½æå–å¾…åŠäº‹é¡¹
- âœ… æ ‡è®°å¾…åŠäº‹é¡¹å®ŒæˆçŠ¶æ€
- ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰ç¬”è®°å’Œå¾…åŠäº‹é¡¹

## é¡¹ç›®ç»“æ„

```
week2/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ db.py                # æ•°æ®åº“æ“ä½œå±‚
â”‚   â”œâ”€â”€ schemas.py           # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ notes.py         # ç¬”è®°ç›¸å…³è·¯ç”±
â”‚   â”‚   â””â”€â”€ action_items.py  # å¾…åŠäº‹é¡¹ç›¸å…³è·¯ç”±
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ extract.py       # LLM æå–æœåŠ¡
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ index.html           # å‰ç«¯ç•Œé¢
â”œâ”€â”€ data/
â”‚   â””â”€â”€ app.db               # SQLite æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test_extract.py      # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ pytest.ini               # pytest é…ç½®
```

## è®¾ç½®ä¸è¿è¡Œ

### å‰ç½®è¦æ±‚

- Python 3.12
- [Ollama](https://ollama.ai/) æœ¬åœ° LLM æœåŠ¡

> ğŸ“– **ç¯å¢ƒé…ç½®**ï¼šConda ç¯å¢ƒçš„åˆ›å»ºä¸æ¿€æ´»ã€Poetry çš„å®‰è£…ï¼Œè¯·å‚è€ƒé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ [README.md](../README.md)ã€‚

### å®‰è£…æ­¥éª¤

1. **ä¸‹è½½å¹¶è¿è¡Œ Ollama æ¨¡å‹**ï¼š

   ```bash
   ollama run llama3.1:8b
   ```

### è¿è¡Œåº”ç”¨

ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```bash
poetry run uvicorn week2.app.main:app --reload
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://127.0.0.1:8000/

## API ç«¯ç‚¹

### ç¬”è®° (Notes)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| `GET` | `/notes` | è·å–æ‰€æœ‰ç¬”è®°åˆ—è¡¨ |
| `POST` | `/notes` | åˆ›å»ºæ–°ç¬”è®° |
| `GET` | `/notes/{note_id}` | è·å–å•ä¸ªç¬”è®°è¯¦æƒ… |

#### è¯·æ±‚/å“åº”ç¤ºä¾‹

**åˆ›å»ºç¬”è®°** `POST /notes`

```json
// è¯·æ±‚
{
  "content": "ä»Šå¤©éœ€è¦å®Œæˆçš„ä»»åŠ¡ï¼š\n- å†™æ–‡æ¡£\n- å¼€ä¼š"
}

// å“åº”
{
  "id": 1,
  "content": "ä»Šå¤©éœ€è¦å®Œæˆçš„ä»»åŠ¡ï¼š\n- å†™æ–‡æ¡£\n- å¼€ä¼š",
  "created_at": "2024-01-15 10:30:00"
}
```

### å¾…åŠäº‹é¡¹ (Action Items)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| `POST` | `/action-items/extract` | ä»æ–‡æœ¬ä¸­æå–å¾…åŠäº‹é¡¹ |
| `GET` | `/action-items` | è·å–æ‰€æœ‰å¾…åŠäº‹é¡¹ï¼ˆå¯æŒ‰ note_id ç­›é€‰ï¼‰ |
| `POST` | `/action-items/{id}/done` | æ ‡è®°å¾…åŠäº‹é¡¹å®ŒæˆçŠ¶æ€ |

#### è¯·æ±‚/å“åº”ç¤ºä¾‹

**æå–å¾…åŠäº‹é¡¹** `POST /action-items/extract`

```json
// è¯·æ±‚
{
  "text": "Meeting notes:\n- Set up database\n- Implement API endpoint",
  "save_note": true
}

// å“åº”
{
  "note_id": 1,
  "items": [
    {"id": 1, "text": "Set up database"},
    {"id": 2, "text": "Implement API endpoint"}
  ]
}
```

**è·å–å¾…åŠäº‹é¡¹** `GET /action-items?note_id=1`

```json
[
  {
    "id": 1,
    "note_id": 1,
    "text": "Set up database",
    "done": false,
    "created_at": "2024-01-15 10:30:00"
  }
]
```

**æ ‡è®°å®Œæˆ** `POST /action-items/1/done`

```json
// è¯·æ±‚
{
  "done": true
}
```

## æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
cd week2
poetry run pytest tests/ -v
```

### ä»…è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆä¸éœ€è¦ Ollamaï¼‰

```bash
poetry run pytest tests/ -v -m "not integration"
```

### è¿è¡Œé›†æˆæµ‹è¯•ï¼ˆéœ€è¦ Ollama è¿è¡Œä¸­ï¼‰

```bash
poetry run pytest tests/ -v -m integration
```

### æµ‹è¯•è¦†ç›–èŒƒå›´

- **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯• `_deduplicate` å‡½æ•°å’Œ LLM é”™è¯¯å¤„ç†
- **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•çœŸå® LLM è°ƒç”¨åœºæ™¯
  - Bullet list æ ¼å¼è¯†åˆ«
  - TODO/ACTION å…³é”®è¯è¯†åˆ«
  - ç©ºè¾“å…¥å¤„ç†

## æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**ï¼šFastAPI
- **æ•°æ®åº“**ï¼šSQLite
- **æ•°æ®éªŒè¯**ï¼šPydantic
- **LLM æœåŠ¡**ï¼šOllama (llama3.1:8b)
- **æµ‹è¯•æ¡†æ¶**ï¼špytest
- **åŒ…ç®¡ç†**ï¼šPoetry

## å¼€å‘è¯´æ˜

### æ•°æ®åº“åˆå§‹åŒ–

æ•°æ®åº“ä¼šåœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–ï¼Œåˆ›å»º `notes` å’Œ `action_items` ä¸¤å¼ è¡¨ã€‚

### LLM é…ç½®

é»˜è®¤ä½¿ç”¨ `llama3.1:8b` æ¨¡å‹ï¼Œå¯åœ¨ `app/services/extract.py` ä¸­ä¿®æ”¹æ¨¡å‹é…ç½®ã€‚
